<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Service Account Details</title><link rel="stylesheet" href="/css/style.css"></head>
<body><nav class="navbar"><div class="container"><div class="nav-brand">üîê Device Auth</div>
<div class="nav-menu"><a href="/dashboard">Dashboard</a><a href="/devices">Devices</a>
<a href="/service-accounts" class="active">Service Accounts</a><span>üë§ <%= user.name %></span><a href="/auth/logout">Logout</a></div></div></nav>
<div class="main-content"><div class="container"><h1><%= account.name %></h1>
<div class="account-status"><span class="badge <%= account.status %>"><%= account.status %></span>
<span class="badge <%= account.type %>"><%= account.type %></span></div>
<div class="details-grid"><div class="details-card"><h2>Account Information</h2>
<div class="info-row"><span class="label">Account ID:</span><span class="value"><%= account.credentials.accountId %></span></div>
<div class="info-row"><span class="label">Key Prefix:</span><span class="value"><code><%= account.credentials.keyPrefix %></code></span></div>
<div class="info-row"><span class="label">Type:</span><span class="value"><%= account.type %></span></div>
<div class="info-row"><span class="label">Description:</span><span class="value"><%= account.description || 'N/A' %></span></div></div>
<div class="details-card"><h2>Permissions & Access</h2>
<div class="permissions-list"><% if (account.permissions.length > 0) { %>
<% account.permissions.forEach(perm => { %><span class="permission-badge"><%= perm %></span><% }); %>
<% } else { %><p>No permissions assigned</p><% } %></div>
<h3>Scopes</h3><div class="scopes-list"><% if (account.scopes.length > 0) { %>
<% account.scopes.forEach(scope => { %><span class="scope-badge"><%= scope %></span><% }); %>
<% } else { %><p>No scopes assigned</p><% } %></div></div>
<div class="details-card"><h2>Rate Limits</h2>
<div class="info-row"><span class="label">Per Minute:</span><span class="value"><%= account.rateLimit.requestsPerMinute %> requests</span></div>
<div class="info-row"><span class="label">Per Hour:</span><span class="value"><%= account.rateLimit.requestsPerHour %> requests</span></div>
<div class="info-row"><span class="label">Per Day:</span><span class="value"><%= account.rateLimit.requestsPerDay %> requests</span></div></div>
<div class="details-card"><h2>Usage Statistics</h2>
<div class="info-row"><span class="label">Total Requests:</span><span class="value"><%= account.stats.totalRequests %></span></div>
<div class="info-row"><span class="label">Successful:</span><span class="value"><%= account.stats.successfulRequests %></span></div>
<div class="info-row"><span class="label">Failed:</span><span class="value"><%= account.stats.failedRequests %></span></div>
<div class="info-row"><span class="label">Last Used:</span><span class="value"><%= account.stats.lastUsed ? new Date(account.stats.lastUsed).toLocaleString() : 'Never' %></span></div></div>
<div class="details-card"><h2>Audit Trail</h2>
<div class="info-row"><span class="label">Created By:</span><span class="value"><%= account.audit.createdBy %></span></div>
<div class="info-row"><span class="label">Created At:</span><span class="value"><%= new Date(account.createdAt).toLocaleString() %></span></div>
<div class="info-row"><span class="label">Last Modified:</span><span class="value"><%= account.updatedAt ? new Date(account.updatedAt).toLocaleString() : 'N/A' %></span></div>
<% if (account.expiresAt) { %><div class="info-row"><span class="label">Expires At:</span>
<span class="value"><%= new Date(account.expiresAt).toLocaleString() %></span></div><% } %></div></div>
<div class="actions-section"><h2>Actions</h2>
<button onclick="changeStatus()" class="btn btn-secondary">Change Status</button>
<button onclick="deleteAccount()" class="btn btn-danger">Delete Account</button></div>
<script>
function changeStatus(){const newStatus=prompt('Enter new status (active/inactive/revoked):');if(newStatus){fetch('/service-accounts/<%= account.id %>/status',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({status:newStatus})}).then(r=>r.json()).then(data=>{if(data.success){alert('Status updated');location.reload()}else{alert('Error: '+data.error)}}).catch(e=>alert('Error updating status'))}}
function deleteAccount(){if(confirm('Are you sure you want to delete this service account? This cannot be undone.')){fetch('/service-accounts/<%= account.id %>',{method:'DELETE'}).then(r=>r.json()).then(data=>{if(data.success){alert('Account deleted');window.location='/service-accounts'}else{alert('Error: '+data.error)}}).catch(e=>alert('Error deleting account'))}}
</script></div></div></body></html>
