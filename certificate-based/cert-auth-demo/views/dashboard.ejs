<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <span class="logo">ğŸ”</span>
                <span>Certificate Auth</span>
            </div>
            <div class="nav-menu">
                <a href="/dashboard" class="nav-link active">Dashboard</a>
                <a href="/dashboard/profile" class="nav-link">Profile</a>
                <a href="/dashboard/cert-details" class="nav-link">Certificate</a>
                <span class="nav-user">ğŸ”‘ <%= user.commonName %></span>
                <a href="/auth/logout" class="nav-link logout">Logout</a>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <div class="container">
            <h1>Welcome, <%= user.commonName %>!</h1>
            <p class="subtitle">Authenticated via Client Certificate</p>

            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h2>ğŸ‘¤ User Information</h2>
                    <div class="info-row">
                        <span class="label">Common Name:</span>
                        <span class="value"><%= user.commonName %></span>
                    </div>
                    <div class="info-row">
                        <span class="label">Email:</span>
                        <span class="value"><%= user.email || 'N/A' %></span>
                    </div>
                    <div class="info-row">
                        <span class="label">Organization:</span>
                        <span class="value"><%= user.organization || 'N/A' %></span>
                    </div>
                    <div class="info-row">
                        <span class="label">Country:</span>
                        <span class="value"><%= user.country || 'N/A' %></span>
                    </div>
                </div>

                <div class="dashboard-card">
                    <h2>ğŸ” Certificate Status</h2>
                    <div class="info-row">
                        <span class="label">Serial Number:</span>
                        <span class="value code"><%= certificate.serialNumber %></span>
                    </div>
                    <div class="info-row">
                        <span class="label">Valid From:</span>
                        <span class="value"><%= new Date(certificate.validFrom).toLocaleDateString() %></span>
                    </div>
                    <div class="info-row">
                        <span class="label">Valid To:</span>
                        <span class="value"><%= new Date(certificate.validTo).toLocaleDateString() %></span>
                    </div>
                    <div class="info-row">
                        <span class="label">Issuer:</span>
                        <span class="value"><%= certificate.issuer.CN %></span>
                    </div>
                </div>
            </div>

            <div class="features-section">
                <h2>ğŸ“Š Available Features</h2>
                <div class="feature-grid">
                    <a href="/dashboard/profile" class="feature-box">
                        <span class="box-icon">ğŸ‘¤</span>
                        <h3>Profile</h3>
                        <p>View your complete profile and certificate information</p>
                    </a>

                    <a href="/dashboard/cert-details" class="feature-box">
                        <span class="box-icon">ğŸ“œ</span>
                        <h3>Certificate Details</h3>
                        <p>Detailed X.509 certificate structure and extensions</p>
                    </a>

                    <a href="/dashboard/cert-chain" class="feature-box">
                        <span class="box-icon">ğŸ”—</span>
                        <h3>Certificate Chain</h3>
                        <p>View the complete chain of trust to root CA</p>
                    </a>

                    <a href="/dashboard/mtls-info" class="feature-box">
                        <span class="box-icon">ğŸ¤</span>
                        <h3>mTLS Information</h3>
                        <p>Mutual TLS connection details and cipher info</p>
                    </a>

                    <a href="/dashboard/validate" class="feature-box">
                        <span class="box-icon">âœ…</span>
                        <h3>Validate Certificate</h3>
                        <p>Test certificate validation against CA</p>
                    </a>

                    <a href="/cert/setup" class="feature-box">
                        <span class="box-icon">âš™ï¸</span>
                        <h3>Setup Guide</h3>
                        <p>Certificate installation and configuration</p>
                    </a>
                </div>
            </div>

            <div class="cert-info-card">
                <h2>ğŸ”‘ Certificate Fingerprint</h2>
                <p class="fingerprint"><%= certificate.fingerprint256 %></p>
                <p class="hint">This unique identifier verifies your certificate's authenticity</p>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 Certificate-Based Authentication Demo</p>
        </div>
    </footer>
</body>
</html>
