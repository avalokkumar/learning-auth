<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title><%= title %></title>
<link rel="stylesheet" href="/css/style.css"></head><body><nav class="navbar"><div class="container">
<div class="nav-brand">üîê MFA Demo</div><div class="nav-menu"><a href="/dashboard">Dashboard</a>
<span class="nav-user">üë§ <%= user.username %></span><a href="/dashboard/profile" class="active">Profile</a>
<a href="#" onclick="logout()">Logout</a></div></div></nav><div class="main-content"><div class="container">
<h1>Profile</h1><div class="profile-card"><div class="profile-section"><h2>Account Information</h2>
<div class="info-row"><span class="label">Username:</span><span class="value"><%= fullUser.username %></span></div>
<div class="info-row"><span class="label">Email:</span><span class="value"><%= fullUser.email %></span></div>
<div class="info-row"><span class="label">Phone:</span><span class="value"><%= fullUser.phone || 'Not set' %></span></div>
<div class="info-row"><span class="label">Role:</span><span class="value"><%= fullUser.role %></span></div>
<div class="info-row"><span class="label">User ID:</span><span class="value code"><%= fullUser.id %></span></div></div>
<div class="profile-section"><h2>Security</h2>
<div class="info-row"><span class="label">MFA Enabled:</span>
<span class="value"><%= fullUser.mfaEnabled ? '‚úÖ Yes' : '‚ùå No' %></span></div>
<% if (fullUser.mfaEnabled) { %>
<div class="info-row"><span class="label">Primary Method:</span>
<span class="value"><%= fullUser.mfaPreference ? fullUser.mfaPreference.toUpperCase() : 'N/A' %></span></div><% } %>
<div class="info-row"><span class="label">Member Since:</span>
<span class="value"><%= new Date(fullUser.createdAt).toLocaleDateString() %></span></div>
<div class="info-row"><span class="label">Last Login:</span>
<span class="value"><%= fullUser.lastLogin ? new Date(fullUser.lastLogin).toLocaleString() : 'Never' %></span></div></div>
<div class="profile-section"><h2>Statistics</h2>
<div class="info-row"><span class="label">Total Logins:</span><span class="value"><%= fullUser.stats.loginCount %></span></div>
<div class="info-row"><span class="label">Failed Login Attempts:</span>
<span class="value"><%= fullUser.stats.failedLoginAttempts %></span></div>
<div class="info-row"><span class="label">Failed MFA Attempts:</span>
<span class="value"><%= fullUser.stats.mfaFailedAttempts %></span></div></div>
<div class="profile-section"><h2>Recent Activity</h2>
<% if (auditLogs.length > 0) { %><div class="audit-log">
<% auditLogs.forEach(log => { %>
<div class="log-entry"><span class="log-time"><%= new Date(log.timestamp).toLocaleString() %></span>
<span class="log-action"><%= log.action.replace(/_/g, ' ') %></span></div>
<% }); %></div><% } else { %><p>No recent activity</p><% } %></div></div></div></div>
<script>async function logout(){const res=await fetch('/auth/logout',{method:'POST'});if(res.ok)window.location.href='/';}</script>
</body></html>
