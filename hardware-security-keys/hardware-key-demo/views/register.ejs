<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Register</title><link rel="stylesheet" href="/css/style.css">
<script src="/js/webauthn-client.js"></script></head>
<body><nav class="navbar"><div class="container"><div class="nav-brand">ğŸ”‘ Hardware Keys</div>
<div class="nav-menu"><a href="/">Home</a><a href="/auth/login">Login</a></div></div></nav>
<div class="auth-container"><div class="auth-card"><h1>ğŸ” Register</h1>
<p class="subtitle">Create your passwordless account</p>
<form id="registerForm"><div class="form-group"><label>Username *</label>
<input type="text" id="username" name="username" required placeholder="john.doe"></div>
<div class="form-group"><label>Security Key Name (optional)</label>
<input type="text" id="keyName" placeholder="My YubiKey"></div>
<button type="submit" class="btn btn-primary btn-block">Register with Security Key</button></form>
<div id="status" class="status-message" style="display:none"></div>
<p class="hint">You'll need a hardware security key (YubiKey, Titan) or platform authenticator (Touch ID, Windows Hello)</p></div></div>
<script>
document.getElementById('registerForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const username = document.getElementById('username').value;
  const keyName = document.getElementById('keyName').value;
  const status = document.getElementById('status');
  const btn = e.target.querySelector('button');
  
  try {
    btn.disabled = true;
    btn.textContent = 'Insert and touch your security key...';
    status.style.display = 'block';
    status.className = 'status-message info';
    status.textContent = 'ğŸ”‘ Please insert and touch your security key';
    
    const result = await webauthnClient.register(username, keyName);
    
    status.className = 'status-message success';
    status.textContent = 'âœ… Registration successful! Redirecting...';
    setTimeout(() => window.location.href = '/dashboard', 2000);
  } catch (error) {
    status.className = 'status-message error';
    status.textContent = 'âŒ ' + error.message;
    btn.disabled = false;
    btn.textContent = 'Register with Security Key';
  }
});
</script>
</body></html>
